{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\DELL\\\\Keep Watching\\\\Keep-Watching\\\\client\\\\src\\\\components\\\\components\\\\Rating\\\\Rating.jsx\";\n\n/* eslint-disable no-unused-vars */\nimport React, { useState, useContext } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport axios from \"axios\"; //  import context\n\nimport AuthContext from \"../../../context/Authentication/authenticationContext\"; //  Import styles\n\nimport \"./Rating.Styles.css\";\n\nconst Ratings = props => {\n  const authContext = useContext(AuthContext);\n  const {\n    isAuthenticated,\n    user,\n    loadUser\n  } = authContext;\n  const [loading, setLoading] = useState(false); // eslint-disable-next-line\n  // const [rating, setRating] = useState(-1)\n\n  if (!isAuthenticated) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 25,\n        columnNumber: 13\n      }\n    });\n  }\n\n  const movieID = props.movieID;\n  const userRatings = user.ratings;\n  const userID = user._id;\n  let movieRating = -1;\n\n  for (let i = 0; i < userRatings.length; i++) {\n    if (userRatings[i][0] === movieID) {\n      movieRating = userRatings[i][1];\n    }\n  }\n\n  const rateMovie = async event => {\n    event.preventDefault();\n    setLoading(true);\n    console.log(\"Rating = \", event.target.rating.value);\n    console.log(\"user id = \", userID);\n    console.log(\"movie id = \", movieID);\n    userRatings.push([movieID, Number(event.target.rating.value)]);\n    console.log(\"userRatings = \", userRatings);\n    const updatedUser = await axios.post(\"/api/users/update\", {\n      userID,\n      updateField: \"ratings\",\n      updatedValues: userRatings\n    });\n    console.log(\"updated user = \", updatedUser);\n    loadUser();\n    setLoading(false);\n  };\n\n  if (loading) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"ratings\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 13\n      }\n    }, \"Loaging\");\n  }\n\n  if (movieRating === -1) {\n    //  The user has not yet rated the movie\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"ratings\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 16\n      }\n    }, \"Rate this Movie\"), /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: rateMovie,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"select\", {\n      name: \"rating\",\n      id: \"ratings\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"option\", {\n      value: 1,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 29\n      }\n    }, \"1 Star\"), /*#__PURE__*/React.createElement(\"option\", {\n      value: 2,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 29\n      }\n    }, \"2 Star\"), /*#__PURE__*/React.createElement(\"option\", {\n      value: 3,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 29\n      }\n    }, \"3 Star\"), /*#__PURE__*/React.createElement(\"option\", {\n      value: 4,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 29\n      }\n    }, \"4 Star\"), /*#__PURE__*/React.createElement(\"option\", {\n      value: 5,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 29\n      }\n    }, \"5 Star\")), /*#__PURE__*/React.createElement(\"button\", {\n      type: \"submit\",\n      className: \"button\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 25\n      }\n    }, \"Rate\")));\n  } else {\n    //  user wants to change the rating\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"ratings\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 17\n      }\n    }, \"Your Rating : \", movieRating + \" \", /*#__PURE__*/React.createElement(\"i\", {\n      className: \"fa fa-star\",\n      \"aria-hidden\": \"true\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 53\n      }\n    })));\n  }\n};\n\nexport default Ratings;","map":{"version":3,"sources":["C:/Users/DELL/Keep Watching/Keep-Watching/client/src/components/components/Rating/Rating.jsx"],"names":["React","useState","useContext","Link","axios","AuthContext","Ratings","props","authContext","isAuthenticated","user","loadUser","loading","setLoading","movieID","userRatings","ratings","userID","_id","movieRating","i","length","rateMovie","event","preventDefault","console","log","target","rating","value","push","Number","updatedUser","post","updateField","updatedValues"],"mappings":"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","sourcesContent":["/* eslint-disable no-unused-vars */\r\nimport React, {useState, useContext } from \"react\"\r\nimport { Link}  from \"react-router-dom\"\r\nimport axios from \"axios\"\r\n\r\n\r\n//  import context\r\nimport AuthContext from \"../../../context/Authentication/authenticationContext\"\r\n\r\n//  Import styles\r\nimport \"./Rating.Styles.css\"\r\n\r\n\r\n\r\nconst Ratings =  (props) => {\r\n    const authContext = useContext(AuthContext)\r\n    const {isAuthenticated, user, loadUser} = authContext\r\n\r\n    const [loading, setLoading] = useState(false);\r\n     // eslint-disable-next-line\r\n    // const [rating, setRating] = useState(-1)\r\n\r\n    if(!isAuthenticated){\r\n        return(\r\n            <div>\r\n                {/* <Link to=\"/signin\" className=\"button\">Rate this movie</Link> */}\r\n            </div>\r\n        )\r\n    }\r\n    \r\n    const movieID = props.movieID;\r\n    const userRatings = user.ratings;\r\n    const userID = user._id;\r\n\r\n    let movieRating  = -1\r\n    for(let i = 0; i<userRatings.length; i++){\r\n        if (userRatings[i][0] === movieID ){\r\n            movieRating = userRatings[i][1]\r\n        }\r\n    }\r\n\r\n    const rateMovie = async (event) => {\r\n        event.preventDefault()\r\n        setLoading(true)\r\n        console.log(\"Rating = \", event.target.rating.value)\r\n        console.log(\"user id = \", userID)\r\n        console.log(\"movie id = \", movieID)\r\n        userRatings.push( [movieID, Number(event.target.rating.value)] )\r\n        console.log(\"userRatings = \", userRatings)\r\n        const updatedUser = await axios.post(\"/api/users/update\", {userID, updateField:\"ratings\" , updatedValues:userRatings})\r\n        console.log(\"updated user = \",  updatedUser )\r\n        loadUser()\r\n        setLoading(false)\r\n    }\r\n\r\n    if(loading){\r\n        return(\r\n            <div className=\"ratings\">\r\n\r\n                Loaging\r\n            </div>\r\n        )\r\n    }\r\n\r\n    if (movieRating === -1){\r\n        //  The user has not yet rated the movie\r\n        return(\r\n            <div className=\"ratings\">\r\n               <p>Rate this Movie</p>\r\n                    <form onSubmit={rateMovie}>         \r\n                        <select name=\"rating\" id=\"ratings\">\r\n                            <option value={1}>1 Star</option>\r\n                            <option value={2}>2 Star</option>\r\n                            <option value={3}>3 Star</option>\r\n                            <option value={4}>4 Star</option>\r\n                            <option value={5}>5 Star</option>\r\n                        </select>\r\n                        <button type=\"submit\" className=\"button\">Rate</button>\r\n                    </form>\r\n            </div>\r\n        )\r\n    }else{\r\n        //  user wants to change the rating\r\n        return(\r\n            <div className=\"ratings\">\r\n                <p>Your Rating : {movieRating + \" \"}<i className=\"fa fa-star\" aria-hidden=\"true\"></i></p>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default Ratings"]},"metadata":{},"sourceType":"module"}