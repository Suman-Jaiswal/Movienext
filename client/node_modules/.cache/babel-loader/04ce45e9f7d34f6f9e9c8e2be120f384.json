{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\DELL\\\\Keep Watching\\\\Keep-Watching\\\\client\\\\src\\\\components\\\\components\\\\FolllowUnfollowButton\\\\FollowUnfollowButton.jsx\";\n\n/* eslint-disable no-unused-vars */\nimport React, { useEffect, useState } from \"react\";\nimport axios from \"axios\"; //   importing styles\n\nimport \"./FullowUnfollowButton.styles.css\";\n\nconst FollowUnfollowButton = props => {\n  let {\n    user,\n    nextUser,\n    setFollowing,\n    setFollowers\n  } = props;\n  let [loading, setLoading] = useState(true);\n  let [operationType, setOperationType] = useState(\"follow\");\n  const user_id = user._id;\n  const nextUser_id = nextUser.data._id;\n  const user_userName = user.username;\n  const next_user_username = nextUser.data.username;\n  let userFollowers = user.followers;\n  let userFollowing = user.following;\n  let nextFollowers = nextUser.data.followers;\n  let nextFollowing = nextUser.data.following;\n  let updatedUserFollowing = userFollowing;\n  let updatednextFollowers = nextFollowers;\n  useEffect(() => {\n    let operationset = false;\n\n    for (let i = 0; i < userFollowing.length; i++) {\n      if (userFollowing[i][0] == nextUser_id) {\n        console.log(\"user already follows rhe next user thus showing unfollow button\");\n        setLoading(false);\n        setOperationType(\"unfollow\");\n        operationset = true;\n        break;\n      }\n    }\n\n    if (!operationset) {\n      for (let i = 0; i < nextFollowing.length; i++) {\n        if (nextFollowing[i][0] == user_id) {\n          if (operationType != \"unfollow\") {\n            console.log(\"operatin type ====> \", operationType);\n            console.log(\"nrent user showing follow back button\");\n            setLoading(false);\n            setOperationType(\"followBack\");\n            break;\n          }\n        }\n      }\n    }\n\n    setLoading(false);\n  }, []);\n\n  const handelClick = async event => {\n    setLoading(true);\n    event.preventDefault(); // console.clear()\n\n    console.log(\"Operation type = \", operationType);\n\n    if (operationType == \"follow\" || operationType == \"followBack\") {\n      updatedUserFollowing = updatedUserFollowing.filter(following => following[0] != nextUser_id);\n      updatednextFollowers = updatednextFollowers.filter(follower => follower[0] != user_id);\n      updatedUserFollowing.unshift([nextUser_id, next_user_username]);\n      updatednextFollowers.unshift([user_id, user_userName]);\n    } else {\n      updatedUserFollowing = updatedUserFollowing.filter(following => following[0] != nextUser_id);\n      updatednextFollowers = updatednextFollowers.filter(follower => follower[0] != user_id);\n    }\n\n    try {\n      const endpoint = \"/api/users/follow\";\n      const response = await axios.post(endpoint, {\n        user_id,\n        nextUser_id,\n        updatedUserFollowing,\n        updatednextFollowers\n      });\n      setLoading(false);\n\n      if (operationType == \"follow\" || operationType == \"followBack\") {\n        setOperationType(\"unfollow\");\n      } else {\n        for (let i = 0; i < nextFollowing.length; i++) {\n          if (nextFollowing[i][0] == user_id) {\n            console.log(\"next user follows current user showing follow back button\");\n            setLoading(false);\n            setOperationType(\"followBack\");\n            break;\n          } else {\n            setOperationType(\"follow\");\n          }\n        }\n      }\n\n      setFollowers(followers => updatednextFollowers);\n    } catch {\n      console.log(\"Some error in following the user\");\n    }\n  };\n\n  if (loading) {\n    return /*#__PURE__*/React.createElement(\"button\", {\n      className: \"follow-btn-disabled\",\n      disabled: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 17\n      }\n    }, \"Loading \");\n  } else {\n    if (operationType == \"follow\") {\n      return /*#__PURE__*/React.createElement(\"button\", {\n        className: \"follow-btn-\" + operationType,\n        onClick: handelClick,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 16\n        }\n      }, \"Follow \");\n    } else if (operationType == \"followBack\") {\n      return /*#__PURE__*/React.createElement(\"button\", {\n        className: \"follow-btn-\" + operationType,\n        onClick: handelClick,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 17\n        }\n      }, \"Follow Back\");\n    } else {\n      return /*#__PURE__*/React.createElement(\"button\", {\n        className: \"follow-btn-unfollow\",\n        onClick: handelClick,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 17\n        }\n      }, \"Unfollow \");\n    }\n  }\n};\n\nexport default FollowUnfollowButton;","map":{"version":3,"sources":["C:/Users/DELL/Keep Watching/Keep-Watching/client/src/components/components/FolllowUnfollowButton/FollowUnfollowButton.jsx"],"names":["React","useEffect","useState","axios","FollowUnfollowButton","props","user","nextUser","setFollowing","setFollowers","loading","setLoading","operationType","setOperationType","user_id","_id","nextUser_id","data","user_userName","username","next_user_username","userFollowers","followers","userFollowing","following","nextFollowers","nextFollowing","updatedUserFollowing","updatednextFollowers","operationset","i","length","console","log","handelClick","event","preventDefault","filter","follower","unshift","endpoint","response","post"],"mappings":"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","sourcesContent":[" /* eslint-disable no-unused-vars */\r\n import React, {  useEffect, useState} from \"react\"\r\n import axios from \"axios\"\r\n\r\n\r\n//   importing styles\r\nimport \"./FullowUnfollowButton.styles.css\"\r\n\r\n const FollowUnfollowButton =  (props) => {\r\n    let {user, nextUser, setFollowing, setFollowers} = props\r\n    let [loading, setLoading] = useState(true)\r\n    let [operationType, setOperationType] = useState(\"follow\")\r\n  \r\n\r\n    const user_id = user._id\r\n    const nextUser_id  = nextUser.data._id\r\n\r\n    const user_userName = user.username\r\n    const next_user_username = nextUser.data.username\r\n\r\n    let userFollowers = user.followers\r\n    let userFollowing = user.following\r\n\r\n    let nextFollowers = nextUser.data.followers\r\n    let nextFollowing = nextUser.data.following\r\n\r\n    let updatedUserFollowing = userFollowing;\r\n    let updatednextFollowers = nextFollowers;\r\n\r\n\r\n    useEffect(()=>{\r\n        let operationset = false;\r\n        for(let i =0; i < userFollowing.length ; i++ ){\r\n            if(userFollowing[i][0] == nextUser_id){\r\n                console.log(\"user already follows rhe next user thus showing unfollow button\")\r\n                setLoading(false)\r\n                setOperationType(\"unfollow\")\r\n                operationset = true\r\n                break\r\n            }\r\n        }\r\n        if(!operationset){\r\n            for(let i =0; i < nextFollowing.length ; i++ ){\r\n                if(nextFollowing[i][0] == user_id){\r\n                    if(operationType !=\"unfollow\" ){\r\n                        console.log(\"operatin type ====> \", operationType)\r\n                        console.log(\"nrent user showing follow back button\")\r\n                        setLoading(false)\r\n                        setOperationType(\"followBack\")\r\n                        break\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        setLoading(false)\r\n    }, [])\r\n\r\n\r\n\r\n     const handelClick =async (event) => {\r\n        setLoading(true)\r\n        event.preventDefault()\r\n        // console.clear()\r\n        console.log(\"Operation type = \", operationType)\r\n\r\n        if(operationType == \"follow\" || operationType ==\"followBack\"){\r\n            updatedUserFollowing = updatedUserFollowing.filter(following => following[0] != nextUser_id)\r\n            updatednextFollowers = updatednextFollowers.filter(follower => follower[0] != user_id)\r\n            updatedUserFollowing.unshift([nextUser_id, next_user_username])\r\n            updatednextFollowers.unshift([user_id, user_userName])\r\n        }else {\r\n            updatedUserFollowing = updatedUserFollowing.filter(following => following[0] != nextUser_id)\r\n            updatednextFollowers = updatednextFollowers.filter(follower => follower[0] != user_id)\r\n        }\r\n\r\n        try{    \r\n            const endpoint = \"/api/users/follow\"\r\n            const response = await axios.post(endpoint, {\r\n                            user_id,nextUser_id, \r\n                            updatedUserFollowing, updatednextFollowers})\r\n            setLoading(false)          \r\n\r\n            if(operationType == \"follow\" || operationType ==\"followBack\"){\r\n                setOperationType(\"unfollow\")\r\n            }else{\r\n                for(let i =0; i < nextFollowing.length ; i++ ){\r\n                    if(nextFollowing[i][0] == user_id){\r\n                        console.log(\"next user follows current user showing follow back button\")\r\n                        setLoading(false)\r\n                        setOperationType(\"followBack\")\r\n                        break\r\n                    }else{\r\n                        setOperationType(\"follow\")\r\n                    }\r\n                }\r\n            }\r\n            setFollowers(followers => updatednextFollowers)\r\n            \r\n        }catch{\r\n            console.log(\"Some error in following the user\")\r\n        }\r\n     }\r\n\r\n     if(loading){\r\n         return <button className=\"follow-btn-disabled\" disabled>Loading </button>\r\n     }else{\r\n        if(operationType==\"follow\"){\r\n            return(\r\n               <button className={\"follow-btn-\" + operationType} onClick={handelClick}>Follow </button>\r\n            )\r\n        }else if(operationType == \"followBack\"){\r\n            return(\r\n                <button className={\"follow-btn-\" + operationType} onClick={handelClick}>Follow Back</button>\r\n             )\r\n        }else{\r\n            return(\r\n                <button className={\"follow-btn-unfollow\"} onClick={handelClick}>Unfollow </button>\r\n             )\r\n        }\r\n     }\r\n}\r\n\r\nexport default FollowUnfollowButton"]},"metadata":{},"sourceType":"module"}