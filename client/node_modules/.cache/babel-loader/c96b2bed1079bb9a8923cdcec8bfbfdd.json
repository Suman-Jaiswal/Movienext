{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\DELL\\\\Keep Watching\\\\Keep-Watching\\\\client\\\\src\\\\components\\\\components\\\\AddToWatchList\\\\AddToWatchList.jsx\";\n\n/* eslint-disable no-unused-vars */\nimport React, { useContext, useEffect, useState } from \"react\";\nimport axios from \"axios\"; //  import context\n\nimport AuthContext from \"../../../context/Authentication/authenticationContext\"; //  importing styles \n\nimport \"./AddToWatchList.style.css\";\n\nconst AddtoWatchlist = props => {\n  const {\n    movieID,\n    movieInfo,\n    tick\n  } = props;\n  let [loading, setLoading] = useState(false); // console.log(\"Movie iiiid = \", movieID)\n  // console.log(\"MOvie info = \", movieInfo)\n\n  const [operation, setOperation] = useState(\"addToWatchlist\"); // const movie_id = movie_info.id\n\n  const authContext = useContext(AuthContext);\n  const {\n    isAuthenticated,\n    user,\n    loadUser\n  } = authContext;\n  let matchFound;\n  let watchlist;\n  useEffect(() => {\n    if (user) {\n      watchlist = user.watchlist;\n      matchFound = user.watchlist.filter(movie => movie.id == movieID);\n\n      if (matchFound.length > 0) {\n        setOperation(\"removeFromWatchlist\");\n      }\n    }\n  }, [isAuthenticated]);\n\n  if (!isAuthenticated) {\n    return /*#__PURE__*/React.createElement(React.Fragment, null);\n  } // console.log(\"user === \", user._id)\n\n\n  const handelClick = async event => {\n    event.preventDefault(); // console.clear()\n\n    setLoading(true);\n    console.log(\"Watchlist == \", user.watchlist);\n    const newmovie = {\n      id: movieInfo.id,\n      poster_path: movieInfo.poster_path,\n      original_title: movieInfo.original_title\n    };\n    watchlist = user.watchlist.filter(movie => movie.id != movieID);\n    console.log(\"operation = \", operation);\n\n    if (operation == \"addToWatchlist\") {\n      watchlist.unshift(newmovie);\n    } else {\n      watchlist = watchlist.filter(film => film.id != movieInfo.id);\n      console.log(\"new watchlist = \", watchlist);\n    }\n\n    try {\n      const endpoint = \"/api/users/updateWatchlist\";\n      const response = await axios.post(endpoint, {\n        userID: user._id,\n        watchlist\n      });\n      console.log(\"response = \", response);\n      matchFound = user.watchlist.filter(movie => movie.id == movieID);\n\n      if (operation == \"addToWatchlist\") {\n        matchFound = true;\n        setOperation(\"removeFromWatchlist\");\n      } else {\n        matchFound = false;\n\n        if (!tick) {\n          setOperation(\"addToWatchlist\");\n        }\n      }\n\n      setLoading(false);\n      loadUser();\n    } catch (error) {\n      setLoading(false);\n      console.log(\"Error in adding to watchlistv-->\", error.message);\n      loadUser();\n    }\n  };\n\n  if (loading) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: `watchlist-container ${tick && \"tick\"}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: `loading-watchlist-button ${tick && \"tick\"}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 17\n      }\n    }, tick ? \":\" : \"Loading\"));\n  }\n\n  if (operation == \"removeFromWatchlist\") {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: `watchlist-container ${tick && \"tick\"}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: `remove-watchlist-button ${tick && \"tick\"}`,\n      onClick: handelClick,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 17\n      }\n    }, tick ? \" - \" : \"Remove from watch list\"));\n  } else {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: `watchlist-container ${tick && \"tick\"}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: `add-watchlist-button ${tick && \"tick\"}`,\n      onClick: handelClick,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 17\n      }\n    }, tick ? \" + \" : \"Add to watch list\"));\n  }\n};\n\nexport default AddtoWatchlist;","map":{"version":3,"sources":["C:/Users/DELL/Keep Watching/Keep-Watching/client/src/components/components/AddToWatchList/AddToWatchList.jsx"],"names":["React","useContext","useEffect","useState","axios","AuthContext","AddtoWatchlist","props","movieID","movieInfo","tick","loading","setLoading","operation","setOperation","authContext","isAuthenticated","user","loadUser","matchFound","watchlist","filter","movie","id","length","handelClick","event","preventDefault","console","log","newmovie","poster_path","original_title","unshift","film","endpoint","response","post","userID","_id","error","message"],"mappings":"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","sourcesContent":["/* eslint-disable no-unused-vars */\r\nimport React, { useContext, useEffect, useState } from \"react\"\r\nimport axios from \"axios\"\r\n\r\n\r\n//  import context\r\nimport AuthContext from \"../../../context/Authentication/authenticationContext\"\r\n\r\n//  importing styles \r\nimport \"./AddToWatchList.style.css\"\r\n\r\nconst AddtoWatchlist = (props) => {\r\n    const { movieID, movieInfo, tick } = props\r\n    let [loading, setLoading] = useState(false)\r\n\r\n    // console.log(\"Movie iiiid = \", movieID)\r\n    // console.log(\"MOvie info = \", movieInfo)\r\n    const [operation, setOperation] = useState(\"addToWatchlist\")\r\n    // const movie_id = movie_info.id\r\n    const authContext = useContext(AuthContext)\r\n    const { isAuthenticated, user, loadUser } = authContext\r\n    let matchFound\r\n    let watchlist\r\n    useEffect(() => {\r\n\r\n        if (user) {\r\n            watchlist = user.watchlist\r\n            matchFound = user.watchlist.filter(movie => movie.id == movieID)\r\n            if (matchFound.length > 0) {\r\n                setOperation(\"removeFromWatchlist\")\r\n            }\r\n        }\r\n    }, [isAuthenticated])\r\n    if (!isAuthenticated) {\r\n        return <></>\r\n    }\r\n    // console.log(\"user === \", user._id)\r\n\r\n    const handelClick = async (event) => {\r\n        event.preventDefault()\r\n        // console.clear()\r\n        setLoading(true)\r\n        console.log(\"Watchlist == \", user.watchlist)\r\n        const newmovie = {\r\n            id: movieInfo.id,\r\n            poster_path: movieInfo.poster_path,\r\n            original_title: movieInfo.original_title\r\n        }\r\n        watchlist = user.watchlist.filter(movie => movie.id != movieID)\r\n        console.log(\"operation = \", operation)\r\n        if (operation == \"addToWatchlist\") {\r\n            watchlist.unshift(newmovie)\r\n        } else {\r\n            watchlist = watchlist.filter(film => film.id != movieInfo.id)\r\n            console.log(\"new watchlist = \", watchlist)\r\n        }\r\n\r\n        try {\r\n            const endpoint = \"/api/users/updateWatchlist\"\r\n            const response = await axios.post(endpoint, {\r\n                userID: user._id,\r\n                watchlist\r\n            })\r\n\r\n            console.log(\"response = \", response)\r\n            matchFound = user.watchlist.filter(movie => movie.id == movieID)\r\n            if (operation == \"addToWatchlist\") {\r\n                matchFound = true\r\n                setOperation(\"removeFromWatchlist\")\r\n            } else {\r\n                matchFound = false\r\n                if (!tick) {\r\n\r\n                    setOperation(\"addToWatchlist\")\r\n                }\r\n            }\r\n            setLoading(false)\r\n            loadUser()\r\n        } catch (error) {\r\n            setLoading(false)\r\n            console.log(\"Error in adding to watchlistv-->\", error.message)\r\n            loadUser()\r\n        }\r\n\r\n\r\n    }\r\n    if (loading) {\r\n        return (\r\n            <div className={`watchlist-container ${tick && \"tick\"}`}>\r\n                <button className={`loading-watchlist-button ${tick && \"tick\"}`} >\r\n                    {tick ? \":\" : \"Loading\"}\r\n                </button>\r\n            </div>\r\n\r\n        )\r\n    }\r\n    if (operation == \"removeFromWatchlist\") {\r\n\r\n        return (\r\n            <div className={`watchlist-container ${tick && \"tick\"}`}>\r\n                <button className={`remove-watchlist-button ${tick && \"tick\"}`} onClick={handelClick}>\r\n                    {tick ? \" - \" : \"Remove from watch list\"}\r\n                </button>\r\n            </div>\r\n        )\r\n    } else {\r\n        return (\r\n            <div className={`watchlist-container ${tick && \"tick\"}`}>\r\n                <button className={`add-watchlist-button ${tick && \"tick\"}`} onClick={handelClick}>\r\n                    {tick ? \" + \" : \"Add to watch list\"}\r\n                </button>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default AddtoWatchlist\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}